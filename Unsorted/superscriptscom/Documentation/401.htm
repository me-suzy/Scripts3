<html>

<head>
<title>401 Scubber Password Hurler Blocker Installation</title>
<meta name="description" content="Protect your password site by immunizing yourself against
    password hurlers.&nbsp; 401 Neutralizer intercepts failed login attempts virtually
    instantly and blocks the refering IP address to send the attacker off to find easier prey.
    &nbsp; Logs attacking addresses so you can hunt down the guilty party and torture them at
    your convenience">
<meta name="keywords" content="password hurler,pennywise,password traders,security software,stop password traders,adult webmaster,secure,password site,hackers">
<meta name="robots" content="index">
<meta name="revisit-after" Content="14 days">

<meta name="Microsoft Border" content="t, default"></head>

<body bgcolor="#ffffff" marginheight="0" marginwidth="0" leftMargin="0" topMargin="0" alink="#003399" vlink="#003399" link="#003399"><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><td>

<table border="0" width="33%" cellpadding="0">
  <tr>
    <td width="50%"><font color="#000000" face="Arial"><a href="http://www.superscripts.com/" ONCLICK="parent.f=0"><img src="../pix/banners/miniprizm.gif" alt="cgi scripts" border="0" WIDTH="305" HEIGHT="59"></a></font></td>
    <td width="50%" bgcolor="#FFFFFF"><font color="#000000" face="Arial"><a href="http://www.superscripts.com/ads/rotate.cgi?url=&amp;user=" target="new" ONCLICK="parent.f=0"><img src="http://www.superscripts.com/ads/rotate.cgi?banner=&amp;user=" border="0" width="468" height="60"></a></font></td>
  </tr>
</table>

<table border="0" width="79%" cellpadding="0">
  <tr>
    <td width="16%"><p align="center"><a href="../dsstoday/index.html"><font color="#000000" face="Arial"><img src="../pix/main/news.jpg" alt="CGI NEWS" align="left" WIDTH="105" HEIGHT="65"></font></a></td>
    <td width="16%"><p align="center"><a href="../scripts/index.shtml"><font color="#000000" face="Arial"><img src="../pix/main/scripts.jpg" alt="CGI Scripts" WIDTH="105" HEIGHT="65"></font></a></td>
    <td width="17%"><p align="center"><a href="../mastergate/index.html"><font color="#000000" face="Arial"><img src="../pix/main/access.jpg" alt="Access The CGI Archive" WIDTH="105" HEIGHT="65"></font></a></td>
    <td width="17%"><p align="center"><a href="../contact.html"><font color="#000000" face="Arial"><img src="../pix/main/contact.jpg" alt="Contact Superscripts" WIDTH="104" HEIGHT="68"></font></a></td>
    <td width="17%"><p align="center"><a href="../support.html"><font color="#000000" face="Arial"><img src="../pix/main/dox.jpg" alt="CGI Documentation" WIDTH="105" HEIGHT="65"></font></a></td>
    <td width="17%"><p align="center"><a href="../download/index.shtml"><font color="#000000" face="Arial"><img src="../pix/main/download.jpg" alt="Download CGI Scripts Here" align="right" WIDTH="105" HEIGHT="65"></font></a></td>
  </tr>
  <tr>
    <td width="16%" bgcolor="#000000"><p align="center"><font face="Arial" color="#FFFFFF"><a ONCLICK="parent.f=0" href="/dsstoday/index.html" style="color: rgb(255,255,255)"><strong>News</strong></a></font></td>
    <td width="16%" bgcolor="#000000"><p align="center"><a href="/scripts/" style="color: rgb(255,255,255)"><font face="Arial" color="#FFFFFF"><strong>CGI Scripts</strong></font></a></td>
    <td width="17%" bgcolor="#000000"><p align="center"><a style="color: rgb(255,255,255)" href="../mastergate/index.html"><font face="Arial" color="#FFFFFF"><strong>Become A Member</strong></font></a></td>
    <td width="17%" bgcolor="#000000"><p align="center"><font face="Arial" color="#FFFFFF"><a ONCLICK="parent.f=0" style="color: rgb(255,255,255)" href="../contact.html"><strong>Contact
    Us</strong></a></font></td>
    <td width="17%" bgcolor="#000000"><p align="center"><font face="Arial" color="#FFFFFF"><a ONCLICK="parent.f=0" style="color: rgb(255,255,255)" href="../support.html"><strong>Support</strong></a></font></td>
    <td width="17%" bgcolor="#000000"><p align="center"><font face="Arial" color="#FFFFFF"><a ONCLICK="parent.f=0" href="/download/index.shtml" style="color: rgb(255,255,255)"><strong>Download
    Area</strong></a></font></td>
  </tr>
</table>

<p>&nbsp;</p>
</td></tr><!--msnavigation--></table><!--msnavigation--><table border="0" cellpadding="0" cellspacing="0" width="100%"><tr><!--msnavigation--><td valign="top">

<table border="0" width="75%" cellpadding="0">
  <tr>
    <td width="100%"><blockquote>
      <p><big><font face="Arial" color="#FF0000"><strong><big>Documentation<br>
      </big></strong></font><font color="#000000" face="Arial">401 SCRUBBER PASSWORD HURLER
      BLOCKER <big>:&nbsp; V1.1</big></font></big><font face="Arial"></p>
      <blockquote>
        <p><small><font color="#000000">Copyright 2001 Psybercore</font></font><font color="#000000" face="Arial">, Inc. - All Rights Reserved. </font></small><font face="Arial"></p>
      </blockquote>
      <blockquote>
        <p><small><font color="#000000" face="Arial">Selling redistributing or modifying any or
        all of the code for this program without prior written consent is expressly forbidden. You
        must obtain written permission before redistributing this software over the Internet or in
        any other medium. In all cases copyright and header information must remain intact.</font></small></p>
      </blockquote>
      <p><font color="#000000" face="Arial"><strong>System Requirements</strong></font></p>
      <blockquote>
        <ul>
          <li><small><font color="#000000">Works on all operating systems</font></small></li>
          <li><small><font color="#000000">Apache web server</font></small></li>
          <li><small><font color="#000000">Access logs</font></small></li>
          <li><small><font color="#000000">.htaccess ability</font></small></li>
          <li><small><font color="#000000">Telnet access</font></small></li>
          <li><small><font color="#000000">Perl 5</font></small></li>
          <li><small><font color="#000000">Crontab recommended</font></small></li>
          <li><small><font color="#000000">Ability to run multiple access_log recommended</font></small></font></li>
        </ul>
      </blockquote>
      <p><big><font color="#000000" face="Arial">Installation</font></big></p>
      <blockquote>
        <p><big><font color="#000000" face="Arial">Preliminaries</font></big></p>
      </blockquote>
      <blockquote>
        <ul>
          <li><small><font color="#000000" face="Arial">Determine the path to PERL 5 on your web
            server host.&nbsp; Note that some web hosting companies run both PERL 4 and PERL 5.&nbsp;
            Make ABSOLUTELY sure you are not setting this up under PERL 4.&nbsp; Ask your
            administrator if you are not sure. </font></small></li>
          <li><font color="#000000" face="Arial"><small><a href="/download/">DOWNLOAD</a> the tarfile
            for this program and save it to your desktop.</small></font> </li>
          <li><small><font color="#000000" face="Arial">Unpack the tar archive on your desktop using a
            program that unpacks UNIX TAR ARCHIVES. Ideally, tar archives are best unpacked on a
            webaccount that has telnet access with the command </font><font face="Arial" color="#FF0000">tar xvf filename.tar.&nbsp; </font><font color="#000000" face="Arial">However,
            in this modern era of lame webhosting companies that do not offer telnet access most of
            the time you can also unpack with a program called winzip which you can download FREE from
            <a href="http://www.shareware.com/">SHAREWARE.COM</a>.&nbsp; Please note that winzip has a
            few bugs and fails to unpack directory structures, files that begin with dots (.) and
            files that are 0K.</font></small></li>
          <li><font color="#000000" face="Arial"><small>After you have unpacked the TAR archive you
            will have a collection of folders and files on your desktop.&nbsp; Now you have to do some
            basic editing of each of these files (or at least some of them).&nbsp; Use a text editor
            such as wordpad, notepad, BBEdit, simpletext, or teachtext to edit the files.&nbsp; These
            are NOT WORD PROCESSOR DOCUMENTS they are just simple TEXT files so don't save them as
            word processor documents or save them with extensions such as .txt or they will NOT WORK.
            &nbsp; Note that there may be a some files inside of folders which are &quot;blank&quot;.
            &nbsp; This is normal.</small></font></li>
          <li><font color="#000000" face="Arial"><small>Make sure you clear out any blank lines from
            database type files included with the tar archive.&nbsp; These files will appear to be
            just blank text files.&nbsp; However, blank lines are present because of the bug in
            winzip.&nbsp; If you see files that appear to be blank make sure to select and erase ALL
            blank lines (select all, then delete).&nbsp; Then resave the file so it is completely
            blank.</small></font></li>
        </ul>
      </blockquote>
      <blockquote>
        <p><font color="#000000" face="Arial"><big>Path to Perl 5 (NOT PERL 4!#%@#$%!)</big></font></p>
      </blockquote>
      <blockquote>
        <blockquote>
          <p><small><font color="#ff0000" face="Arial">Define Path To PERL 5</font></small></p>
        </blockquote>
        <blockquote>
          <p><font color="#000000" face="Arial"><small>The first step is to open up each and every
          file that has a .cgi extension and edit line number one of each script.&nbsp; Each of the
          cgi scripts is written in perl 5. For your scripts to run they must know where perl 5 is
          installed on your web server. The path to perl 5 is defined to a cgi script in the first
          line of the file. In each of the cgi scripts the first line of code looks something like
          this: </small></font></p>
          <blockquote>
            <p><font color="#ff0000" face="Arial"><small>#!/usr/bin/perl</small></font></p>
          </blockquote>
          <p><font color="#000000" face="Arial"><small>If the path to perl 5 on your web server is
          different from /usr/bin/perl you must edit the first line of each cgi script to reflect
          the correct path. If the path to perl 5 is the same no changes are necessary. If you do
          not know the path to perl 5 ask the webmaster or system administrator at your server site.
          &nbsp; </small></font></p>
          <p><font color="#000000" face="Arial"><small>If your isp is still running perl 4 you might
          want to inform them that perl 4 was great back in the 1980's or whatever but perl 5 has
          been out for a LONG time and is pretty much downward compatible.&nbsp; Perl 4 is pretty
          much useless today but you would be surprised how many isps run both perl 4 and perl 5
          like its actually helping you.</small></font></p>
        </blockquote>
      </blockquote>
      <blockquote>
        <p><font color="#000000" face="Arial"><big>Configure the .cgi files</big></font></p>
        <blockquote>
          <p><font color="#000000" face="Arial"><small>Configure the following variables located
          inside of 401.cgi (see the user configuration area)</small></font><font SIZE="2"><ul>
            </font>
            <li><font SIZE="2"></font><font color="#FF0000" face="Arial" SIZE="2">$logfile =
              &quot;/full/path/to/401LOGFILE&quot;;</font><font SIZE="2"></font></li>
            <li><font SIZE="2"><font color="#FF0000" face="Arial" SIZE="2">$blockfile =
              &quot;/full/path/to/blocked&quot;;</font></font></li>
            <li><font SIZE="2"><font color="#FF0000" face="Arial" SIZE="2">$htaccess =
              &quot;/full/path/to/.htaccess&quot;;</font></font></li>
            <li><font SIZE="2"><font color="#FF0000" face="Arial" SIZE="2">$threshold = 3;</font></font></li>
            <li><font SIZE="2"><font color="#FF0000" face="Arial" SIZE="2">$pointer= 8;</font></font></li>
            <font SIZE="2">
          </ul>
          <ul>
            <li><font color="#FF0000" face="Arial" SIZE="2">$logfile </font><font SIZE="2" face="Arial" color="#000000">FULL PATH TO YOUR LOG FILE OR SECONDARY LOG SCAN FILE</font></li>
            <li><font color="#FF0000" face="Arial" SIZE="2">$blockfile </font><font SIZE="2" face="Arial" color="#000000">FULL PATH TO THE BLOCKED FILE</font></li>
            <li><font color="#FF0000" face="Arial" SIZE="2">$htaccess </font><font SIZE="2" face="Arial" color="#000000">FULL PATH TO .htaccess FILE IN YOUR ROOT HTML DIRECTORY</font></li>
            <li><font color="#FF0000" face="Arial" SIZE="2">$threshold </font></font><font face="Arial" color="#000000" SIZE="2">SET TO A REASONABLE VALUE SO YOU DON'T KICK OFF THE GOOD USERS
              BUT DO KICK OUT THE LOSERS TRY 25</font><font SIZE="2"></li>
            <li><font color="#FF0000" face="Arial" size="2">$pointer&nbsp; </font><font face="Arial" size="2" color="#000000">SEE THE FILE INCLUDED CALLED <strong>README.LOGINFO.TXT</strong>
              FOR INSTRUCTIONS ON SETTING THIS VARIABLE</font></li>
          </ul>
          </font>
        </blockquote>
        <p><font color="#000000" face="Arial"><big>Upload the files and set permissions</big></font></p>
        <blockquote>
          <p><font color="#000000" face="Arial"><small>Create a directory inside your cgi-bin called
          401 and upload all of the files into this directory.&nbsp; Set the permissions for 401.cgi
          to 755 and the permissions for the rest of the files to 777.&nbsp; Note that the htaccess
          file (rename .htaccess) is NOT supposed to go into your &quot;members&quot; folder. &nbsp;
          This new .htaccess file should go into the root level html directory for your website
          (htdocs, public_html, or whatever).&nbsp; This .htaccess file will block IP addresses
          found inside the &quot;blocked&quot; text file.&nbsp; Make sure you clear out any blank
          lines inside of the &quot;blocked&quot; file.&nbsp; The blank line is only there because
          of a bug in winzip.&nbsp; If you do not remove it the scrubber will not work right.</small></font></p>
        </blockquote>
      </blockquote>
      <blockquote>
        <p><font color="#000000" face="Arial"><big>Notes on running the software</big></font></p>
        <blockquote>
          <p><font color="#000000" face="Arial"><small>401.cgi should ideally be set to run from
          crontab perhaps once per minute.&nbsp; You can also run the script by telnet command line
          using</small></font></p>
          <blockquote>
            <p><font face="Arial" color="#FF0000"><small>perl 401.cgi</small></font></p>
          </blockquote>
          <p><font color="#000000" face="Arial"><small>The script will scan the log file looking for
          excessive failed login attempts from the same IP address.&nbsp; If the number of failed
          logins is greater than the threshold value the IP address of the attacker will be added to
          the &quot;blocked&quot; file.&nbsp; The &quot;blocked&quot; file is used by .htaccess to
          deny further access to your web server.&nbsp; </small></font></p>
          <p><font color="#000000" face="Arial"><small>Optimally, you should have your isp setup
          duplicate log files for you.&nbsp; This is easily done by adding a second line to the
          apache config file like this</small></font><font SIZE="2"><ul>
            <li></font><font face="Arial" SIZE="2" color="#000000">&lt;VirtualHost 209.212.196.253&gt; </font><font SIZE="2"></li>
            <li></font><font face="Arial" SIZE="2" color="#000000">ServerAdmin
              webmaster@webshoppingonline.net </font><font SIZE="2"></li>
            <li></font><font face="Arial" SIZE="2" color="#000000">DocumentRoot
              /home/httpd/html/webshoppingonline.net/htdocs/ </font><font SIZE="2"></li>
            <li></font><font SIZE="2" face="Arial" color="#FF0000">TransferLog
              /home/httpd/html/logs/webshoppingonline.net </font><font SIZE="2"></li>
            <li></font><font SIZE="2" face="Arial" color="#FF0000">TransferLog
              /home/httpd/html/logs/webshoppingonline-copy.net</font><font SIZE="2"></li>
            <li></font><font face="Arial" SIZE="2" color="#000000">ServerName webshoppingonline.net </font><font SIZE="2"></li>
            <li></font><font face="Arial" SIZE="2" color="#000000">ServerAlias www.webshoppingonline.net
              </font><font SIZE="2"></li>
            <li></font><font face="Arial" SIZE="2" color="#000000">&lt;/VirtualHost&gt; </font><font SIZE="2"></li>
          </ul>
          </font><p><font face="Arial" color="#000000"><small>This way when crontab executes 401.cgi
          it will parse the smaller logfile COPY rather than the regular logfile which would cost
          you a lot of CPU time.&nbsp; If you cannot setup a duplicate logfile then you should only
          run this maybe once per hour.&nbsp; You should set the logfile copy permissions to 777 so
          they can be reset to 0k everytime 401.cgi runs.&nbsp; If you get attacked by a hurler it
          will be obvious within seconds.&nbsp; </small></font></p>
          <p><font face="Arial" color="#000000"><small>If you are going to have 401.cgi reset your
          logfiles to keep serverload to a minimum, you will need to add the following line to the
          end of 401.cgi to have it clear the logfile back to 0K after execution by crontab.</small></font></p>
          <font SIZE="2"><p></font><font SIZE="2" face="Arial" color="#FF0000">open (LOGFILE,
          &quot;&gt;$logfile&quot;);</font></p>
          <p><font face="Arial" color="#000000"><small>Just keep in mind that if you are attacked by
          a hurler they will be throwing maybe 1,000 passwords per minute and cause several hundred
          401 errors.&nbsp; If its just a member trying to remember their username/password you
          don't want to block them so do not set the threshold too low.</small></font></p>
          <p><font face="Arial" color="#000000"><small>Another consideration is make sure your
          password software doesn't allow username=password or allow user/passwords less than 4
          characters long.&nbsp; A hurler takes a lot longer to break long user/password
          combinations.&nbsp; Nearly ALL of them also only attack accounts where the
          username=password.&nbsp; So these hurlers really only threaten sites run by lame gateway
          software.&nbsp; And you can believe me when I tell you that when a hacker finds a weak
          password software system it isn't but a few days later all his friends and their websites
          have detailed procedures figured out and published on cracking them.&nbsp; When this
          happens, hackers simply use search engines to locate sites using the weak software and
          then they break right in.&nbsp; If your site has problems with hackers we can help you.
          &nbsp; There are several other security scripts on our site which are best installed by an
          expert (programmer).&nbsp; However, there are also instructions available on our site for
          you &quot;do-it-yourselfers&quot;.&nbsp; </small></font></p>
        </blockquote>
        <p><font face="Arial" color="#000000"><big>Setting the &quot;$pointer&quot; variable</big></font></p>
        <blockquote>
          <font SIZE="2"><p></font><font face="Arial" size="2">This variable will determine whether
          the script will work or not.&nbsp; If you don't set this EXACTLY right then forget it - it
          WILL NOT WORK.&nbsp; There are SIMPLE instructions for anyone that can count to 20 inside
          of the file called<font color="#000000"> </font></font><strong><font face="Arial" size="2" color="#000000">README.LOGINFO.TXT</font></strong><font SIZE="2"></p>
          <p></font><strong><font face="Arial" color="#000000" size="7">R</font><font size="7"><font color="#000000"><font face="Arial">EAD IT!!!</font></font></strong><ul>
            <li></font><font SIZE="2"><font color="#FF0000"><font face="Arial">with referal type logs it
              will normally be set to 8</font></font></li>
          </ul>
          <p><font face="Arial">this &quot;pointer&quot; must point to the &quot;200&quot; field in
          your logfiles</font></font></p>
        </blockquote>
      </blockquote>
    </blockquote>
    </td>
  </tr>
</table>
&nbsp;<!--msnavigation--></td></tr><!--msnavigation--></table></body>
</html>
